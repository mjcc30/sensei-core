[2m2025-12-06T17:28:27.620651Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m âœ… Loaded prompts from prompts.yaml
[2m2025-12-06T17:28:27.683974Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m ðŸ“¦ Connecting to database: sqlite://sensei.db?mode=rwc
[2m2025-12-06T17:28:27.702950Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"PRAGMA foreign_keys = ON; â€¦" [3mdb.statement[0m[2m=[0m"\n\nPRAGMA foreign_keys = ON; \n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.573464ms [3melapsed_secs[0m[2m=[0m0.002573464
[2m2025-12-06T17:28:27.728080Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"CREATE TABLE IF NOT â€¦" [3mdb.statement[0m[2m=[0m"\n\n\nCREATE TABLE IF NOT EXISTS _sqlx_migrations (\n    version BIGINT PRIMARY KEY,\n    description TEXT NOT NULL,\n    installed_on TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    success BOOLEAN NOT NULL,\n    checksum BLOB NOT NULL,\n    execution_time BIGINT NOT NULL\n);\n                \n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m24.437255ms [3melapsed_secs[0m[2m=[0m0.024437255
[2m2025-12-06T17:28:27.730113Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT version FROM _sqlx_migrations â€¦" [3mdb.statement[0m[2m=[0m"\n\nSELECT version FROM _sqlx_migrations WHERE success = false ORDER BY version LIMIT 1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m1.635401ms [3melapsed_secs[0m[2m=[0m0.001635401
[2m2025-12-06T17:28:27.731680Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT version, checksum FROM â€¦" [3mdb.statement[0m[2m=[0m"\n\nSELECT version, checksum FROM _sqlx_migrations ORDER BY version\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m1.192635ms [3melapsed_secs[0m[2m=[0m0.001192635
[2m2025-12-06T17:28:27.737226Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"CREATE TABLE IF NOT â€¦" [3mdb.statement[0m[2m=[0m"\n\nCREATE TABLE IF NOT EXISTS sessions (\r\n    id TEXT PRIMARY KEY NOT NULL,\r\n    title TEXT,\r\n    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,\r\n    updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP\r\n);\r\n\r\nCREATE TABLE IF NOT EXISTS messages (\r\n    id TEXT PRIMARY KEY NOT NULL,\r\n    session_id TEXT NOT NULL,\r\n    role TEXT NOT NULL,\r\n    content TEXT NOT NULL,\r\n    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,\r\n    FOREIGN KEY(session_id) REFERENCES sessions(id) ON DELETE CASCADE\r\n);\r\n\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.939829ms [3melapsed_secs[0m[2m=[0m0.004939829
[2m2025-12-06T17:28:27.739007Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO _sqlx_migrations ( â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n    INSERT INTO _sqlx_migrations ( version, description, success, checksum, execution_time )\n    VALUES ( ?1, ?2, TRUE, ?3, -1 )\n                \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m1.405185ms [3melapsed_secs[0m[2m=[0m0.001405185
[2m2025-12-06T17:28:27.763514Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"UPDATE _sqlx_migrations SET execution_time â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n    UPDATE _sqlx_migrations\n    SET execution_time = ?1\n    WHERE version = ?2\n                \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m13.548672ms [3melapsed_secs[0m[2m=[0m0.013548672
[2m2025-12-06T17:28:27.770058Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"CREATE TABLE IF NOT â€¦" [3mdb.statement[0m[2m=[0m"\n\nCREATE TABLE IF NOT EXISTS documents (\r\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n    content TEXT NOT NULL,\r\n    metadata TEXT,\r\n    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP\r\n);\r\n\r\n-- gemini-embedding-001 default is 3072 dimensions\r\nCREATE VIRTUAL TABLE IF NOT EXISTS vec_items USING vec0(\r\n    embedding float[3072]\r\n);\r\n\n" [3mrows_affected[0m[2m=[0m5 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m6.128524ms [3melapsed_secs[0m[2m=[0m0.006128524
[2m2025-12-06T17:28:27.771901Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO _sqlx_migrations ( â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n    INSERT INTO _sqlx_migrations ( version, description, success, checksum, execution_time )\n    VALUES ( ?1, ?2, TRUE, ?3, -1 )\n                \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m1.538168ms [3melapsed_secs[0m[2m=[0m0.001538168
[2m2025-12-06T17:28:27.797478Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"UPDATE _sqlx_migrations SET execution_time â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n    UPDATE _sqlx_migrations\n    SET execution_time = ?1\n    WHERE version = ?2\n                \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m13.958909ms [3melapsed_secs[0m[2m=[0m0.013958909
[2m2025-12-06T17:28:27.803104Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"CREATE TABLE IF NOT â€¦" [3mdb.statement[0m[2m=[0m"\n\nCREATE TABLE IF NOT EXISTS router_cache (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    query_text TEXT NOT NULL,\n    category TEXT NOT NULL,\n    enhanced_query TEXT NOT NULL,\n    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Vector table for router cache (3072 dimensions for gemini-embedding-001)\nCREATE VIRTUAL TABLE IF NOT EXISTS vec_router_cache USING vec0(\n    embedding float[3072]\n);\n\n" [3mrows_affected[0m[2m=[0m5 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m5.238503ms [3melapsed_secs[0m[2m=[0m0.005238503
[2m2025-12-06T17:28:27.805258Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO _sqlx_migrations ( â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n    INSERT INTO _sqlx_migrations ( version, description, success, checksum, execution_time )\n    VALUES ( ?1, ?2, TRUE, ?3, -1 )\n                \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m1.576431ms [3melapsed_secs[0m[2m=[0m0.001576431
[2m2025-12-06T17:28:27.826799Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"UPDATE _sqlx_migrations SET execution_time â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n    UPDATE _sqlx_migrations\n    SET execution_time = ?1\n    WHERE version = ?2\n                \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m11.758624ms [3melapsed_secs[0m[2m=[0m0.011758624
DEBUG: Registering agent for category AgentCategory("red")
DEBUG: Registering agent for category AgentCategory("blue")
DEBUG: Registering agent for category AgentCategory("cloud")
DEBUG: Registering agent for category AgentCategory("crypto")
DEBUG: Registering agent for category AgentCategory("osint")
DEBUG: Registering agent for category AgentCategory("system")
DEBUG: Registering agent for category AgentCategory("casual")
DEBUG: Registering agent for category AgentCategory("novice")
DEBUG: Registering agent for category AgentCategory("action")
DEBUG: Registering agent for category AgentCategory("system")
[2m2025-12-06T17:28:27.832722Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m ðŸ”Œ Loading MCP Servers from mcp_settings.json
[2m2025-12-06T17:28:27.833226Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m    - Connecting to filesystem...
[2m2025-12-06T17:28:27.834015Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(104773491403392), interests=READABLE | WRITABLE
[2m2025-12-06T17:28:27.834189Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(104773492251904), interests=READABLE | WRITABLE
[2m2025-12-06T17:28:27.834367Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(104773491988480), interests=READABLE
Secure MCP Filesystem Server running on stdio
[2m2025-12-06T17:28:28.908067Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T17:28:28.908512Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T17:28:28.908796Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T17:28:28.909138Z[0m [33m WARN[0m [2msensei_server[0m[2m:[0m    âŒ Failed to init MCP Agent 'filesystem': MCP Error -32603: [
  {
    "expected": "object",
    "code": "invalid_type",
    "path": [
      "params",
      "clientInfo"
    ],
    "message": "Invalid input: expected object, received undefined"
  }
]
[2m2025-12-06T17:28:28.909372Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m    - Connecting to git...
[2m2025-12-06T17:28:28.909996Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(104773492242688), interests=READABLE | WRITABLE
[2m2025-12-06T17:28:28.910283Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(104773492261760), interests=READABLE | WRITABLE
[2m2025-12-06T17:28:28.910613Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(104773492083840), interests=READABLE
/usr/bin/python3: No module named mcp_server_git
[2m2025-12-06T17:28:28.924162Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T17:28:28.924510Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T17:28:28.924859Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T17:28:28.925057Z[0m [33m WARN[0m [2msensei_server[0m[2m:[0m    âŒ Failed to init MCP Agent 'git': MCP Server closed connection unexpectedly
[2m2025-12-06T17:28:28.925234Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m ðŸ§  Router Prompt Configured with Extensions: NONE
[2m2025-12-06T17:28:28.928166Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(104773491718016), interests=READABLE | WRITABLE
[2m2025-12-06T17:28:28.928431Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m ðŸš€ Sensei Server running on http://0.0.0.0:3000 (Swarm Mode)
[2m2025-12-06T17:28:28.928677Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m âš¡ Fast Model: gemini-2.5-flash
[2m2025-12-06T17:28:28.928954Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m ðŸ§  Smart Model: gemini-3-pro-preview
[2m2025-12-06T17:28:29.112682Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(104773492247296), interests=READABLE | WRITABLE
[2m2025-12-06T17:28:29.113200Z[0m [35mTRACE[0m [2maxum::serve[0m[2m:[0m connection 127.0.0.1:51176 accepted
[2m2025-12-06T17:28:29.117074Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T17:28:29.117823Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(104773492247680), interests=READABLE | WRITABLE
[2m2025-12-06T17:28:29.118049Z[0m [35mTRACE[0m [2maxum::serve[0m[2m:[0m connection 127.0.0.1:51192 accepted
[2m2025-12-06T17:28:29.132994Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO sessions (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO sessions (id, title) VALUES (?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m13.401727ms [3melapsed_secs[0m[2m=[0m0.013401727
[2m2025-12-06T17:28:29.136782Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"PRAGMA foreign_keys = ON; â€¦" [3mdb.statement[0m[2m=[0m"\n\nPRAGMA foreign_keys = ON; \n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m35.685Âµs [3melapsed_secs[0m[2m=[0m3.5685e-5
[2m2025-12-06T17:28:29.153316Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO messages (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO messages (id, session_id, role, content) VALUES (?, ?, ?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m16.017125ms [3melapsed_secs[0m[2m=[0m0.016017125
[2m2025-12-06T17:28:29.158112Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m checkout waiting for idle connection: ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:29.158597Z[0m [34mDEBUG[0m [2mreqwest::connect[0m[2m:[0m starting new connection: https://generativelanguage.googleapis.com/
[2m2025-12-06T17:28:29.159211Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::connect::http[0m[2m:[0m Http::connect; scheme=Some("https"), host=Some("generativelanguage.googleapis.com"), port=None
[2m2025-12-06T17:28:29.165854Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::connect::http[0m[2m:[0m connecting to 216.58.214.74:443
[2m2025-12-06T17:28:29.166126Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(140078345116928), interests=READABLE | WRITABLE
[2m2025-12-06T17:28:29.176602Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::connect::http[0m[2m:[0m connected to 216.58.214.74:443
[2m2025-12-06T17:28:29.199131Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::client[0m[2m:[0m http1 handshake complete, spawning background dispatcher task
[2m2025-12-06T17:28:29.199840Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::client[0m[2m:[0m waiting for connection to be ready
[2m2025-12-06T17:28:29.200086Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::client[0m[2m:[0m connection is ready
[2m2025-12-06T17:28:29.200283Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m checkout dropped for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:29.429668Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T17:28:29.480401Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:29.481069Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:29.486033Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT c.category, c.enhanced_query, v.distance â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT c.category, c.enhanced_query, v.distance\n            FROM vec_router_cache v\n            JOIN router_cache c ON v.rowid = c.id\n            WHERE v.embedding MATCH ? AND k = 1\n            ORDER BY v.distance ASC\n            \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.318688ms [3melapsed_secs[0m[2m=[0m0.004318688
[2m2025-12-06T17:28:29.487486Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T17:28:29.487879Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:30.977766Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T17:28:30.978930Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:30.979590Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
DEBUG LLM RAW: ```json
{
  "category": "RED",
  "enhanced_query": "Provide a guide on performing SQL injection on a login page, including a specific UNION-based payload example."
}
```
[2m2025-12-06T17:28:31.020791Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO router_cache (query_text, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO router_cache (query_text, category, enhanced_query) VALUES (?, ?, ?) RETURNING id\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m39.434481ms [3melapsed_secs[0m[2m=[0m0.039434481
[2m2025-12-06T17:28:31.646467Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO vec_router_cache (rowid, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO vec_router_cache (rowid, embedding) VALUES (?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m624.897038ms [3melapsed_secs[0m[2m=[0m0.624897038
ðŸ§  Routing query 'How to perform a SQL injection on a login page? Give a specific payload example using UNION.' to AgentCategory("red") (Optimized: 'Provide a guide on performing SQL injection on a login page, including a specific UNION-based payload example.')
[2m2025-12-06T17:28:31.799451Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m checkout waiting for idle connection: ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:31.799878Z[0m [34mDEBUG[0m [2mreqwest::connect[0m[2m:[0m starting new connection: https://generativelanguage.googleapis.com/
[2m2025-12-06T17:28:31.800155Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::connect::http[0m[2m:[0m Http::connect; scheme=Some("https"), host=Some("generativelanguage.googleapis.com"), port=None
[2m2025-12-06T17:28:31.812233Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::connect::http[0m[2m:[0m connecting to 172.217.18.202:443
[2m2025-12-06T17:28:31.813532Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(140078210928896), interests=READABLE | WRITABLE
[2m2025-12-06T17:28:31.824154Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::connect::http[0m[2m:[0m connected to 172.217.18.202:443
[2m2025-12-06T17:28:31.842113Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::client[0m[2m:[0m http1 handshake complete, spawning background dispatcher task
[2m2025-12-06T17:28:31.842747Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::client[0m[2m:[0m waiting for connection to be ready
[2m2025-12-06T17:28:31.843106Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::client[0m[2m:[0m connection is ready
[2m2025-12-06T17:28:31.843438Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m checkout dropped for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:32.152686Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T17:28:32.177513Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:32.178193Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:32.181911Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT d.content, v.distance FROM â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT d.content, v.distance\n            FROM vec_items v\n            JOIN documents d ON v.rowid = d.id\n            WHERE v.embedding MATCH ? AND k = ?\n            ORDER BY v.distance\n            \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.421398ms [3melapsed_secs[0m[2m=[0m0.003421398
[2m2025-12-06T17:28:32.182617Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T17:28:32.182920Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:33.927535Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m DEBUG: Watcher checking mcp_settings.json...
[2m2025-12-06T17:28:40.675473Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m DEBUG: Watcher checking mcp_settings.json...
[2m2025-12-06T17:28:45.679387Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m DEBUG: Watcher checking mcp_settings.json...
[2m2025-12-06T17:28:50.363898Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T17:28:50.364812Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:50.365219Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:50.425974Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO messages (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO messages (id, session_id, role, content) VALUES (?, ?, ?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m50.747024ms [3melapsed_secs[0m[2m=[0m0.050747024
[2m2025-12-06T17:28:50.426555Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T17:28:50.427695Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(104773492225152), interests=READABLE | WRITABLE
[2m2025-12-06T17:28:50.428065Z[0m [35mTRACE[0m [2maxum::serve[0m[2m:[0m connection 127.0.0.1:34796 accepted
[2m2025-12-06T17:28:50.448044Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO sessions (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO sessions (id, title) VALUES (?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m19.311402ms [3melapsed_secs[0m[2m=[0m0.019311402
[2m2025-12-06T17:28:50.472868Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO messages (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO messages (id, session_id, role, content) VALUES (?, ?, ?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m24.020351ms [3melapsed_secs[0m[2m=[0m0.024020351
[2m2025-12-06T17:28:50.473452Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T17:28:50.473718Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:50.681771Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m DEBUG: Watcher checking mcp_settings.json...
[2m2025-12-06T17:28:50.746394Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T17:28:50.748362Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:50.748642Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:51.400539Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT c.category, c.enhanced_query, v.distance â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT c.category, c.enhanced_query, v.distance\n            FROM vec_router_cache v\n            JOIN router_cache c ON v.rowid = c.id\n            WHERE v.embedding MATCH ? AND k = 1\n            ORDER BY v.distance ASC\n            \n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m651.301848ms [3melapsed_secs[0m[2m=[0m0.651301848
[2m2025-12-06T17:28:51.401066Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T17:28:51.401305Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:54.447053Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T17:28:54.448339Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:54.448919Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
DEBUG LLM RAW: ```json
{
  "category": "RED",
  "enhanced_query": "Python script to perform a SYN Flood attack using raw sockets for stress testing a server."
}
```
[2m2025-12-06T17:28:54.489084Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO router_cache (query_text, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO router_cache (query_text, category, enhanced_query) VALUES (?, ?, ?) RETURNING id\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m38.018905ms [3melapsed_secs[0m[2m=[0m0.038018905
[2m2025-12-06T17:28:54.498584Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO vec_router_cache (rowid, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO vec_router_cache (rowid, embedding) VALUES (?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m8.571125ms [3melapsed_secs[0m[2m=[0m0.008571125
ðŸ§  Routing query 'Write a Python script to perform a SYN Flood attack for stress testing my own server. Include raw socket creation. --raw' to AgentCategory("red") (Optimized: 'Python script to perform a SYN Flood attack using raw sockets for stress testing a server.')
[2m2025-12-06T17:28:54.510529Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T17:28:54.510780Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:54.714988Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T17:28:54.717097Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:54.717390Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:54.720598Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT d.content, v.distance FROM â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT d.content, v.distance\n            FROM vec_items v\n            JOIN documents d ON v.rowid = d.id\n            WHERE v.embedding MATCH ? AND k = ?\n            ORDER BY v.distance\n            \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.930473ms [3melapsed_secs[0m[2m=[0m0.002930473
[2m2025-12-06T17:28:54.721184Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T17:28:54.721538Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:28:55.685934Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m DEBUG: Watcher checking mcp_settings.json...
[2m2025-12-06T17:29:00.689050Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m DEBUG: Watcher checking mcp_settings.json...
[2m2025-12-06T17:29:05.692110Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m DEBUG: Watcher checking mcp_settings.json...
[2m2025-12-06T17:29:12.492418Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m DEBUG: Watcher checking mcp_settings.json...
[2m2025-12-06T17:29:13.262663Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T17:29:13.263785Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:13.264305Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:13.291647Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO messages (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO messages (id, session_id, role, content) VALUES (?, ?, ?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m27.269925ms [3melapsed_secs[0m[2m=[0m0.027269925
[2m2025-12-06T17:29:13.292388Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T17:29:13.293965Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(104773491726848), interests=READABLE | WRITABLE
[2m2025-12-06T17:29:13.294345Z[0m [35mTRACE[0m [2maxum::serve[0m[2m:[0m connection 127.0.0.1:47340 accepted
[2m2025-12-06T17:29:13.309550Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO sessions (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO sessions (id, title) VALUES (?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m14.699093ms [3melapsed_secs[0m[2m=[0m0.014699093
[2m2025-12-06T17:29:13.323996Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO messages (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO messages (id, session_id, role, content) VALUES (?, ?, ?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m14.073911ms [3melapsed_secs[0m[2m=[0m0.014073911
[2m2025-12-06T17:29:13.324305Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T17:29:13.324469Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:13.591390Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T17:29:13.592803Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:13.593019Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:14.194751Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT c.category, c.enhanced_query, v.distance â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT c.category, c.enhanced_query, v.distance\n            FROM vec_router_cache v\n            JOIN router_cache c ON v.rowid = c.id\n            WHERE v.embedding MATCH ? AND k = 1\n            ORDER BY v.distance ASC\n            \n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m601.495276ms [3melapsed_secs[0m[2m=[0m0.601495276
[2m2025-12-06T17:29:14.195211Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T17:29:14.195432Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:15.095732Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
DEBUG LLM RAW: ```json
{
  "category": "SYSTEM",
  "enhanced_query": "Methods and tools to detect a reverse shell in Linux system logs."
}
```
[2m2025-12-06T17:29:15.096513Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:15.098499Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:15.135619Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO router_cache (query_text, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO router_cache (query_text, category, enhanced_query) VALUES (?, ?, ?) RETURNING id\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m36.953294ms [3melapsed_secs[0m[2m=[0m0.036953294
[2m2025-12-06T17:29:15.141227Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO vec_router_cache (rowid, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO vec_router_cache (rowid, embedding) VALUES (?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m5.219309ms [3melapsed_secs[0m[2m=[0m0.005219309
ðŸ§  Routing query 'Detect a reverse shell in linux logs' to AgentCategory("system") (Optimized: 'Methods and tools to detect a reverse shell in Linux system logs.')
[2m2025-12-06T17:29:15.154920Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T17:29:15.155191Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:15.399906Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T17:29:15.401621Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:15.401929Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:15.404069Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT d.content, v.distance FROM â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT d.content, v.distance\n            FROM vec_items v\n            JOIN documents d ON v.rowid = d.id\n            WHERE v.embedding MATCH ? AND k = ?\n            ORDER BY v.distance\n            \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.028742ms [3melapsed_secs[0m[2m=[0m0.002028742
[2m2025-12-06T17:29:15.404482Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T17:29:15.404714Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:16.497470Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T17:29:16.498283Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:16.498803Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:16.547582Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO messages (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO messages (id, session_id, role, content) VALUES (?, ?, ?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m48.776256ms [3melapsed_secs[0m[2m=[0m0.048776256
[2m2025-12-06T17:29:16.548390Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T17:29:16.549478Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(104773491727232), interests=READABLE | WRITABLE
[2m2025-12-06T17:29:16.549715Z[0m [35mTRACE[0m [2maxum::serve[0m[2m:[0m connection 127.0.0.1:47350 accepted
[2m2025-12-06T17:29:16.566934Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO sessions (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO sessions (id, title) VALUES (?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m16.556806ms [3melapsed_secs[0m[2m=[0m0.016556806
[2m2025-12-06T17:29:16.585186Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO messages (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO messages (id, session_id, role, content) VALUES (?, ?, ?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m17.745787ms [3melapsed_secs[0m[2m=[0m0.017745787
[2m2025-12-06T17:29:16.585566Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T17:29:16.585766Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:16.888361Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T17:29:16.889673Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:16.890072Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:17.492934Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT c.category, c.enhanced_query, v.distance â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT c.category, c.enhanced_query, v.distance\n            FROM vec_router_cache v\n            JOIN router_cache c ON v.rowid = c.id\n            WHERE v.embedding MATCH ? AND k = 1\n            ORDER BY v.distance ASC\n            \n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m602.749971ms [3melapsed_secs[0m[2m=[0m0.602749971
[2m2025-12-06T17:29:17.493345Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T17:29:17.493524Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:17.495934Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m DEBUG: Watcher checking mcp_settings.json...
[2m2025-12-06T17:29:19.817157Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
DEBUG LLM RAW: ```json
{
  "category": "CASUAL",
  "enhanced_query": "What is your identity and purpose?"
}
```
[2m2025-12-06T17:29:19.818058Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:19.819097Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:19.841777Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO router_cache (query_text, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO router_cache (query_text, category, enhanced_query) VALUES (?, ?, ?) RETURNING id\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m22.552386ms [3melapsed_secs[0m[2m=[0m0.022552386
[2m2025-12-06T17:29:19.847477Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO vec_router_cache (rowid, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO vec_router_cache (rowid, embedding) VALUES (?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m5.330246ms [3melapsed_secs[0m[2m=[0m0.005330246
ðŸ§  Routing query 'Hello Sensei, who are you?' to AgentCategory("casual") (Optimized: 'What is your identity and purpose?')
[2m2025-12-06T17:29:19.859031Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T17:29:19.859286Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:20.108528Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T17:29:20.110374Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:20.110724Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:20.113051Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT d.content, v.distance FROM â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT d.content, v.distance\n            FROM vec_items v\n            JOIN documents d ON v.rowid = d.id\n            WHERE v.embedding MATCH ? AND k = ?\n            ORDER BY v.distance\n            \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.209544ms [3melapsed_secs[0m[2m=[0m0.002209544
[2m2025-12-06T17:29:20.113462Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T17:29:20.113656Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:21.899809Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T17:29:21.901247Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:21.901536Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:21.916595Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO messages (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO messages (id, session_id, role, content) VALUES (?, ?, ?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m14.982496ms [3melapsed_secs[0m[2m=[0m0.014982496
[2m2025-12-06T17:29:21.917326Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T17:29:21.918489Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(104773491727232), interests=READABLE | WRITABLE
[2m2025-12-06T17:29:21.918810Z[0m [35mTRACE[0m [2maxum::serve[0m[2m:[0m connection 127.0.0.1:47362 accepted
[2m2025-12-06T17:29:21.919402Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T17:29:21.919727Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:22.159372Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T17:29:22.161185Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:22.161660Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:22.499231Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m DEBUG: Watcher checking mcp_settings.json...
[2m2025-12-06T17:29:22.791633Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT c.category, c.enhanced_query, v.distance â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT c.category, c.enhanced_query, v.distance\n            FROM vec_router_cache v\n            JOIN router_cache c ON v.rowid = c.id\n            WHERE v.embedding MATCH ? AND k = 1\n            ORDER BY v.distance ASC\n            \n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m629.84388ms [3melapsed_secs[0m[2m=[0m0.62984388
[2m2025-12-06T17:29:22.792212Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T17:29:22.792489Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:24.869141Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T17:29:24.870274Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:24.870803Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
DEBUG LLM RAW: ```json
{
  "category": "SYSTEM",
  "enhanced_query": "Determine server network latency"
}
```
[2m2025-12-06T17:29:24.910695Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO router_cache (query_text, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO router_cache (query_text, category, enhanced_query) VALUES (?, ?, ?) RETURNING id\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m38.029112ms [3melapsed_secs[0m[2m=[0m0.038029112
[2m2025-12-06T17:29:24.917430Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO vec_router_cache (rowid, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO vec_router_cache (rowid, embedding) VALUES (?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m6.122119ms [3melapsed_secs[0m[2m=[0m0.006122119
[2m2025-12-06T17:29:24.928128Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T17:29:24.928966Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(104773491727232), interests=READABLE | WRITABLE
[2m2025-12-06T17:29:24.929314Z[0m [35mTRACE[0m [2maxum::serve[0m[2m:[0m connection 127.0.0.1:47266 accepted
[2m2025-12-06T17:29:24.929813Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T17:29:24.930143Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:25.155395Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T17:29:25.158213Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:25.158549Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:25.774758Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT rowid, distance FROM â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT rowid, distance\n            FROM vec_router_cache\n            WHERE embedding MATCH ? AND k = 1\n            ORDER BY distance ASC\n            \n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m615.986739ms [3melapsed_secs[0m[2m=[0m0.615986739
[2m2025-12-06T17:29:25.779671Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"UPDATE router_cache SET category â€¦" [3mdb.statement[0m[2m=[0m"\n\nUPDATE router_cache SET category = ? WHERE id = ?\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.856151ms [3melapsed_secs[0m[2m=[0m0.002856151
âœ… Corrected router cache for 'Check server latency' -> AgentCategory("system")
[2m2025-12-06T17:29:25.780470Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T17:29:25.781478Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(104773491727232), interests=READABLE | WRITABLE
[2m2025-12-06T17:29:25.781822Z[0m [35mTRACE[0m [2maxum::serve[0m[2m:[0m connection 127.0.0.1:47274 accepted
[2m2025-12-06T17:29:25.782411Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T17:29:25.782758Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:26.013510Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T17:29:26.014731Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:26.014945Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T17:29:26.625906Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT c.category, c.enhanced_query, v.distance â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT c.category, c.enhanced_query, v.distance\n            FROM vec_router_cache v\n            JOIN router_cache c ON v.rowid = c.id\n            WHERE v.embedding MATCH ? AND k = 1\n            ORDER BY v.distance ASC\n            \n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m610.765423ms [3melapsed_secs[0m[2m=[0m0.610765423
âš¡ Cache Hit! Routing 'Check server latency' to AgentCategory("system") (Saved ~1s)
[2m2025-12-06T17:29:26.626871Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
