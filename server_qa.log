[2m2025-12-06T14:09:53.386186Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m âœ… Loaded prompts from prompts.yaml
[2m2025-12-06T14:09:53.448150Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m ðŸ“¦ Connecting to database: sqlite://sensei.db?mode=rwc
[2m2025-12-06T14:09:53.467702Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"PRAGMA foreign_keys = ON; â€¦" [3mdb.statement[0m[2m=[0m"\n\nPRAGMA foreign_keys = ON; \n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.906985ms [3melapsed_secs[0m[2m=[0m0.002906985
[2m2025-12-06T14:09:53.497457Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"CREATE TABLE IF NOT â€¦" [3mdb.statement[0m[2m=[0m"\n\n\nCREATE TABLE IF NOT EXISTS _sqlx_migrations (\n    version BIGINT PRIMARY KEY,\n    description TEXT NOT NULL,\n    installed_on TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    success BOOLEAN NOT NULL,\n    checksum BLOB NOT NULL,\n    execution_time BIGINT NOT NULL\n);\n                \n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m28.608831ms [3melapsed_secs[0m[2m=[0m0.028608831
[2m2025-12-06T14:09:53.498922Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT version FROM _sqlx_migrations â€¦" [3mdb.statement[0m[2m=[0m"\n\nSELECT version FROM _sqlx_migrations WHERE success = false ORDER BY version LIMIT 1\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m1.2425ms [3melapsed_secs[0m[2m=[0m0.0012425
[2m2025-12-06T14:09:53.500522Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT version, checksum FROM â€¦" [3mdb.statement[0m[2m=[0m"\n\nSELECT version, checksum FROM _sqlx_migrations ORDER BY version\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m1.092117ms [3melapsed_secs[0m[2m=[0m0.001092117
[2m2025-12-06T14:09:53.505064Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"CREATE TABLE IF NOT â€¦" [3mdb.statement[0m[2m=[0m"\n\nCREATE TABLE IF NOT EXISTS sessions (\r\n    id TEXT PRIMARY KEY NOT NULL,\r\n    title TEXT,\r\n    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,\r\n    updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP\r\n);\r\n\r\nCREATE TABLE IF NOT EXISTS messages (\r\n    id TEXT PRIMARY KEY NOT NULL,\r\n    session_id TEXT NOT NULL,\r\n    role TEXT NOT NULL,\r\n    content TEXT NOT NULL,\r\n    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,\r\n    FOREIGN KEY(session_id) REFERENCES sessions(id) ON DELETE CASCADE\r\n);\r\n\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.822886ms [3melapsed_secs[0m[2m=[0m0.003822886
[2m2025-12-06T14:09:53.505950Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO _sqlx_migrations ( â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n    INSERT INTO _sqlx_migrations ( version, description, success, checksum, execution_time )\n    VALUES ( ?1, ?2, TRUE, ?3, -1 )\n                \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m722.656Âµs [3melapsed_secs[0m[2m=[0m0.000722656
[2m2025-12-06T14:09:53.525873Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"UPDATE _sqlx_migrations SET execution_time â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n    UPDATE _sqlx_migrations\n    SET execution_time = ?1\n    WHERE version = ?2\n                \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m11.307557ms [3melapsed_secs[0m[2m=[0m0.011307557
[2m2025-12-06T14:09:53.530943Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"CREATE TABLE IF NOT â€¦" [3mdb.statement[0m[2m=[0m"\n\nCREATE TABLE IF NOT EXISTS documents (\r\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n    content TEXT NOT NULL,\r\n    metadata TEXT,\r\n    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP\r\n);\r\n\r\n-- gemini-embedding-001 default is 3072 dimensions\r\nCREATE VIRTUAL TABLE IF NOT EXISTS vec_items USING vec0(\r\n    embedding float[3072]\r\n);\r\n\n" [3mrows_affected[0m[2m=[0m5 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.648468ms [3melapsed_secs[0m[2m=[0m0.004648468
[2m2025-12-06T14:09:53.531866Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO _sqlx_migrations ( â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n    INSERT INTO _sqlx_migrations ( version, description, success, checksum, execution_time )\n    VALUES ( ?1, ?2, TRUE, ?3, -1 )\n                \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m700.069Âµs [3melapsed_secs[0m[2m=[0m0.000700069
[2m2025-12-06T14:09:53.551647Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"UPDATE _sqlx_migrations SET execution_time â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n    UPDATE _sqlx_migrations\n    SET execution_time = ?1\n    WHERE version = ?2\n                \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m11.802865ms [3melapsed_secs[0m[2m=[0m0.011802865
[2m2025-12-06T14:09:53.556778Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"CREATE TABLE IF NOT â€¦" [3mdb.statement[0m[2m=[0m"\n\nCREATE TABLE IF NOT EXISTS router_cache (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    query_text TEXT NOT NULL,\n    category TEXT NOT NULL,\n    enhanced_query TEXT NOT NULL,\n    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Vector table for router cache (3072 dimensions for gemini-embedding-001)\nCREATE VIRTUAL TABLE IF NOT EXISTS vec_router_cache USING vec0(\n    embedding float[3072]\n);\n\n" [3mrows_affected[0m[2m=[0m5 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m4.665754ms [3melapsed_secs[0m[2m=[0m0.004665754
[2m2025-12-06T14:09:53.558176Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO _sqlx_migrations ( â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n    INSERT INTO _sqlx_migrations ( version, description, success, checksum, execution_time )\n    VALUES ( ?1, ?2, TRUE, ?3, -1 )\n                \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m1.142987ms [3melapsed_secs[0m[2m=[0m0.001142987
[2m2025-12-06T14:09:53.578834Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"UPDATE _sqlx_migrations SET execution_time â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n    UPDATE _sqlx_migrations\n    SET execution_time = ?1\n    WHERE version = ?2\n                \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m12.459659ms [3melapsed_secs[0m[2m=[0m0.012459659
[2m2025-12-06T14:09:53.581522Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(109511095929472), interests=READABLE | WRITABLE
[2m2025-12-06T14:09:53.581712Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m ðŸš€ Sensei Server running on http://0.0.0.0:3000 (Swarm Mode)
[2m2025-12-06T14:09:53.581881Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m âš¡ Fast Model: gemini-2.5-flash
[2m2025-12-06T14:09:53.582050Z[0m [32m INFO[0m [2msensei_server[0m[2m:[0m ðŸ§  Smart Model: gemini-3-pro-preview
[2m2025-12-06T14:09:53.879972Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(109511095666688), interests=READABLE | WRITABLE
[2m2025-12-06T14:09:53.880836Z[0m [35mTRACE[0m [2maxum::serve[0m[2m:[0m connection 127.0.0.1:36590 accepted
[2m2025-12-06T14:09:53.886466Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T14:09:53.887324Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(109511095779456), interests=READABLE | WRITABLE
[2m2025-12-06T14:09:53.887609Z[0m [35mTRACE[0m [2maxum::serve[0m[2m:[0m connection 127.0.0.1:36600 accepted
[2m2025-12-06T14:09:53.910827Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO sessions (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO sessions (id, title) VALUES (?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m20.472608ms [3melapsed_secs[0m[2m=[0m0.020472608
[2m2025-12-06T14:09:53.916021Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"PRAGMA foreign_keys = ON; â€¦" [3mdb.statement[0m[2m=[0m"\n\nPRAGMA foreign_keys = ON; \n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m49.026Âµs [3melapsed_secs[0m[2m=[0m4.9026e-5
[2m2025-12-06T14:09:53.930156Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO messages (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO messages (id, session_id, role, content) VALUES (?, ?, ?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m13.56602ms [3melapsed_secs[0m[2m=[0m0.01356602
[2m2025-12-06T14:09:53.934887Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m checkout waiting for idle connection: ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:09:53.935085Z[0m [34mDEBUG[0m [2mreqwest::connect[0m[2m:[0m starting new connection: https://generativelanguage.googleapis.com/
[2m2025-12-06T14:09:53.935724Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::connect::http[0m[2m:[0m Http::connect; scheme=Some("https"), host=Some("generativelanguage.googleapis.com"), port=None
[2m2025-12-06T14:09:53.961852Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::connect::http[0m[2m:[0m connecting to 142.250.178.138:443
[2m2025-12-06T14:09:53.962975Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(127697497906688), interests=READABLE | WRITABLE
[2m2025-12-06T14:09:53.976210Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::connect::http[0m[2m:[0m connected to 142.250.178.138:443
[2m2025-12-06T14:09:53.999215Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::client[0m[2m:[0m http1 handshake complete, spawning background dispatcher task
[2m2025-12-06T14:09:53.999854Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::client[0m[2m:[0m waiting for connection to be ready
[2m2025-12-06T14:09:54.000342Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::client[0m[2m:[0m connection is ready
[2m2025-12-06T14:09:54.000603Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m checkout dropped for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:09:54.219812Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T14:09:54.246146Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:09:54.246957Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:09:54.249623Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT c.category, c.enhanced_query, v.distance â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT c.category, c.enhanced_query, v.distance\n            FROM vec_router_cache v\n            JOIN router_cache c ON v.rowid = c.id\n            WHERE v.embedding MATCH ? AND k = 1\n            ORDER BY v.distance ASC\n            \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.966292ms [3melapsed_secs[0m[2m=[0m0.002966292
[2m2025-12-06T14:09:54.249974Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T14:09:54.250135Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:09:57.630007Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
DEBUG LLM RAW: ```json
{
  "category": "RED",
  "enhanced_query": "Provide a comprehensive guide on executing SQL injection against a login page, with a specific example of a UNION-based payload."
}
```
[2m2025-12-06T14:09:57.630949Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:09:57.631815Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:09:57.642242Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO router_cache (query_text, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO router_cache (query_text, category, enhanced_query) VALUES (?, ?, ?) RETURNING id\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m10.332903ms [3melapsed_secs[0m[2m=[0m0.010332903
[2m2025-12-06T14:09:58.166146Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO vec_router_cache (rowid, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO vec_router_cache (rowid, embedding) VALUES (?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m523.316466ms [3melapsed_secs[0m[2m=[0m0.523316466
ðŸ§  Routing query 'How to perform a SQL injection on a login page? Give a specific payload example using UNION.' to Red (Optimized: 'Provide a comprehensive guide on executing SQL injection against a login page, with a specific example of a UNION-based payload.')
[2m2025-12-06T14:09:58.276962Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m checkout waiting for idle connection: ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:09:58.277283Z[0m [34mDEBUG[0m [2mreqwest::connect[0m[2m:[0m starting new connection: https://generativelanguage.googleapis.com/
[2m2025-12-06T14:09:58.277651Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::connect::http[0m[2m:[0m Http::connect; scheme=Some("https"), host=Some("generativelanguage.googleapis.com"), port=None
[2m2025-12-06T14:09:58.300858Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::connect::http[0m[2m:[0m connecting to 216.58.214.74:443
[2m2025-12-06T14:09:58.301785Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(127697497914112), interests=READABLE | WRITABLE
[2m2025-12-06T14:09:58.315260Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::connect::http[0m[2m:[0m connected to 216.58.214.74:443
[2m2025-12-06T14:09:58.333344Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::client[0m[2m:[0m http1 handshake complete, spawning background dispatcher task
[2m2025-12-06T14:09:58.334042Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::client[0m[2m:[0m waiting for connection to be ready
[2m2025-12-06T14:09:58.334367Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::client[0m[2m:[0m connection is ready
[2m2025-12-06T14:09:58.334707Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m checkout dropped for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:09:58.534992Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T14:09:58.558918Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:09:58.559497Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:09:58.562359Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT d.content, v.distance FROM â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT d.content, v.distance\n            FROM vec_items v\n            JOIN documents d ON v.rowid = d.id\n            WHERE v.embedding MATCH ? AND k = ?\n            ORDER BY v.distance\n            \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.359894ms [3melapsed_secs[0m[2m=[0m0.002359894
[2m2025-12-06T14:09:58.562843Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T14:09:58.563127Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:23.663748Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T14:10:23.664568Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:23.664813Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:23.718707Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO messages (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO messages (id, session_id, role, content) VALUES (?, ?, ?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m46.598123ms [3melapsed_secs[0m[2m=[0m0.046598123
[2m2025-12-06T14:10:23.719181Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T14:10:23.720539Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(109511095779456), interests=READABLE | WRITABLE
[2m2025-12-06T14:10:23.720832Z[0m [35mTRACE[0m [2maxum::serve[0m[2m:[0m connection 127.0.0.1:51676 accepted
[2m2025-12-06T14:10:23.735933Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO sessions (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO sessions (id, title) VALUES (?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m14.345953ms [3melapsed_secs[0m[2m=[0m0.014345953
[2m2025-12-06T14:10:23.750781Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO messages (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO messages (id, session_id, role, content) VALUES (?, ?, ?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m14.322851ms [3melapsed_secs[0m[2m=[0m0.014322851
[2m2025-12-06T14:10:23.751184Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T14:10:23.751432Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:23.979175Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T14:10:23.980410Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:23.980864Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:24.557036Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT c.category, c.enhanced_query, v.distance â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT c.category, c.enhanced_query, v.distance\n            FROM vec_router_cache v\n            JOIN router_cache c ON v.rowid = c.id\n            WHERE v.embedding MATCH ? AND k = 1\n            ORDER BY v.distance ASC\n            \n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m575.754292ms [3melapsed_secs[0m[2m=[0m0.575754292
[2m2025-12-06T14:10:24.557723Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T14:10:24.557996Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:27.299831Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T14:10:27.301344Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
DEBUG LLM RAW: ```json
{
  "category": "RED",
  "enhanced_query": "Request for a Python script to implement a SYN flood attack using raw sockets, intended for stress testing a user's own server."
}
```
[2m2025-12-06T14:10:27.301916Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:27.338588Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO router_cache (query_text, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO router_cache (query_text, category, enhanced_query) VALUES (?, ?, ?) RETURNING id\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m35.714787ms [3melapsed_secs[0m[2m=[0m0.035714787
[2m2025-12-06T14:10:27.345316Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO vec_router_cache (rowid, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO vec_router_cache (rowid, embedding) VALUES (?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m6.062754ms [3melapsed_secs[0m[2m=[0m0.006062754
ðŸ§  Routing query 'Write a Python script to perform a SYN Flood attack for stress testing my own server. Include raw socket creation. --raw' to Red (Optimized: 'Request for a Python script to implement a SYN flood attack using raw sockets, intended for stress testing a user's own server.')
[2m2025-12-06T14:10:27.376799Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T14:10:27.377035Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:27.626898Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T14:10:27.629089Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:27.629436Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:27.633171Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT d.content, v.distance FROM â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT d.content, v.distance\n            FROM vec_items v\n            JOIN documents d ON v.rowid = d.id\n            WHERE v.embedding MATCH ? AND k = ?\n            ORDER BY v.distance\n            \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.346085ms [3melapsed_secs[0m[2m=[0m0.003346085
[2m2025-12-06T14:10:27.633848Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T14:10:27.634176Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:43.186609Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T14:10:43.187735Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:43.188145Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:43.235381Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO messages (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO messages (id, session_id, role, content) VALUES (?, ?, ?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m47.195862ms [3melapsed_secs[0m[2m=[0m0.047195862
[2m2025-12-06T14:10:43.235894Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T14:10:43.237419Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(109511095903616), interests=READABLE | WRITABLE
[2m2025-12-06T14:10:43.237684Z[0m [35mTRACE[0m [2maxum::serve[0m[2m:[0m connection 127.0.0.1:58798 accepted
[2m2025-12-06T14:10:43.251726Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO sessions (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO sessions (id, title) VALUES (?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m13.590076ms [3melapsed_secs[0m[2m=[0m0.013590076
[2m2025-12-06T14:10:43.266217Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO messages (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO messages (id, session_id, role, content) VALUES (?, ?, ?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m13.849615ms [3melapsed_secs[0m[2m=[0m0.013849615
[2m2025-12-06T14:10:43.266625Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T14:10:43.266865Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:43.470966Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T14:10:43.477803Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:43.478432Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:44.030071Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT c.category, c.enhanced_query, v.distance â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT c.category, c.enhanced_query, v.distance\n            FROM vec_router_cache v\n            JOIN router_cache c ON v.rowid = c.id\n            WHERE v.embedding MATCH ? AND k = 1\n            ORDER BY v.distance ASC\n            \n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m551.791199ms [3melapsed_secs[0m[2m=[0m0.551791199
[2m2025-12-06T14:10:44.030586Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T14:10:44.030810Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:50.265069Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
DEBUG LLM RAW: ```json
{
  "category": "BLUE",
  "enhanced_query": "Methods and indicators for detecting reverse shell activity within Linux system logs and network traffic."
}
```
[2m2025-12-06T14:10:50.266022Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:50.266828Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:50.306161Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO router_cache (query_text, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO router_cache (query_text, category, enhanced_query) VALUES (?, ?, ?) RETURNING id\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m39.117783ms [3melapsed_secs[0m[2m=[0m0.039117783
[2m2025-12-06T14:10:50.316908Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO vec_router_cache (rowid, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO vec_router_cache (rowid, embedding) VALUES (?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m10.088957ms [3melapsed_secs[0m[2m=[0m0.010088957
ðŸ§  Routing query 'Detect a reverse shell in linux logs' to Blue (Optimized: 'Methods and indicators for detecting reverse shell activity within Linux system logs and network traffic.')
[2m2025-12-06T14:10:50.330311Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T14:10:50.330529Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:50.562088Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T14:10:50.564097Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:50.564424Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:10:50.567159Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT d.content, v.distance FROM â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT d.content, v.distance\n            FROM vec_items v\n            JOIN documents d ON v.rowid = d.id\n            WHERE v.embedding MATCH ? AND k = ?\n            ORDER BY v.distance\n            \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m2.549128ms [3melapsed_secs[0m[2m=[0m0.002549128
[2m2025-12-06T14:10:50.567615Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T14:10:50.567838Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:32.941995Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m idle interval checking for expired
[2m2025-12-06T14:11:33.776013Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T14:11:33.776965Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:33.777245Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:33.796726Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO messages (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO messages (id, session_id, role, content) VALUES (?, ?, ?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m19.198351ms [3melapsed_secs[0m[2m=[0m0.019198351
[2m2025-12-06T14:11:33.797244Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T14:11:33.799569Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(109511095903616), interests=READABLE | WRITABLE
[2m2025-12-06T14:11:33.799941Z[0m [35mTRACE[0m [2maxum::serve[0m[2m:[0m connection 127.0.0.1:51198 accepted
[2m2025-12-06T14:11:33.815638Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO sessions (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO sessions (id, title) VALUES (?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m15.068369ms [3melapsed_secs[0m[2m=[0m0.015068369
[2m2025-12-06T14:11:33.829185Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO messages (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO messages (id, session_id, role, content) VALUES (?, ?, ?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m12.963512ms [3melapsed_secs[0m[2m=[0m0.012963512
[2m2025-12-06T14:11:33.829636Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T14:11:33.829821Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:34.032728Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T14:11:34.038348Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:34.038653Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:34.571962Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT c.category, c.enhanced_query, v.distance â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT c.category, c.enhanced_query, v.distance\n            FROM vec_router_cache v\n            JOIN router_cache c ON v.rowid = c.id\n            WHERE v.embedding MATCH ? AND k = 1\n            ORDER BY v.distance ASC\n            \n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m533.244933ms [3melapsed_secs[0m[2m=[0m0.533244933
[2m2025-12-06T14:11:34.572527Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T14:11:34.572739Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:35.341949Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T14:11:35.342776Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
DEBUG LLM RAW: ```json
{
  "category": "CASUAL",
  "enhanced_query": "Hello Sensei, who are you?"
}
```
[2m2025-12-06T14:11:35.343116Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:35.379389Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO router_cache (query_text, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO router_cache (query_text, category, enhanced_query) VALUES (?, ?, ?) RETURNING id\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m35.39097ms [3melapsed_secs[0m[2m=[0m0.03539097
[2m2025-12-06T14:11:35.385423Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO vec_router_cache (rowid, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO vec_router_cache (rowid, embedding) VALUES (?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m5.490041ms [3melapsed_secs[0m[2m=[0m0.005490041
ðŸ§  Routing query 'Hello Sensei, who are you?' to Casual (Optimized: 'Hello Sensei, who are you?')
[2m2025-12-06T14:11:35.395857Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T14:11:35.396056Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:35.618799Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T14:11:35.620192Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:35.620615Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:35.624151Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT d.content, v.distance FROM â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT d.content, v.distance\n            FROM vec_items v\n            JOIN documents d ON v.rowid = d.id\n            WHERE v.embedding MATCH ? AND k = ?\n            ORDER BY v.distance\n            \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.155777ms [3melapsed_secs[0m[2m=[0m0.003155777
[2m2025-12-06T14:11:35.624741Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T14:11:35.624969Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:37.254360Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m idle interval checking for expired
[2m2025-12-06T14:11:39.581296Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T14:11:39.582165Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:39.582487Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:39.597672Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO messages (id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO messages (id, session_id, role, content) VALUES (?, ?, ?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m14.975219ms [3melapsed_secs[0m[2m=[0m0.014975219
[2m2025-12-06T14:11:39.598252Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T14:11:39.599318Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(109511095903616), interests=READABLE | WRITABLE
[2m2025-12-06T14:11:39.599482Z[0m [35mTRACE[0m [2maxum::serve[0m[2m:[0m connection 127.0.0.1:51212 accepted
[2m2025-12-06T14:11:39.599963Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T14:11:39.600176Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:39.858060Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T14:11:39.858886Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:39.859268Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:40.408672Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT c.category, c.enhanced_query, v.distance â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT c.category, c.enhanced_query, v.distance\n            FROM vec_router_cache v\n            JOIN router_cache c ON v.rowid = c.id\n            WHERE v.embedding MATCH ? AND k = 1\n            ORDER BY v.distance ASC\n            \n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m549.167219ms [3melapsed_secs[0m[2m=[0m0.549167219
[2m2025-12-06T14:11:40.409183Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T14:11:40.409389Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:43.172799Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T14:11:43.173737Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:43.174242Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
DEBUG LLM RAW: ```json
{
  "category": "SYSTEM",
  "enhanced_query": "Measure network latency to a specified server."
}
```
[2m2025-12-06T14:11:43.211942Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO router_cache (query_text, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO router_cache (query_text, category, enhanced_query) VALUES (?, ?, ?) RETURNING id\n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m35.763107ms [3melapsed_secs[0m[2m=[0m0.035763107
[2m2025-12-06T14:11:43.218098Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"INSERT INTO vec_router_cache (rowid, â€¦" [3mdb.statement[0m[2m=[0m"\n\nINSERT INTO vec_router_cache (rowid, embedding) VALUES (?, ?)\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m5.346156ms [3melapsed_secs[0m[2m=[0m0.005346156
[2m2025-12-06T14:11:43.227704Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T14:11:43.228781Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(109511095903616), interests=READABLE | WRITABLE
[2m2025-12-06T14:11:43.228987Z[0m [35mTRACE[0m [2maxum::serve[0m[2m:[0m connection 127.0.0.1:34214 accepted
[2m2025-12-06T14:11:43.229344Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T14:11:43.229506Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:43.452455Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T14:11:43.453693Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:43.454103Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:44.015851Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT rowid, distance FROM â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT rowid, distance\n            FROM vec_router_cache\n            WHERE embedding MATCH ? AND k = 1\n            ORDER BY distance ASC\n            \n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m561.379921ms [3melapsed_secs[0m[2m=[0m0.561379921
[2m2025-12-06T14:11:44.020085Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"UPDATE router_cache SET category â€¦" [3mdb.statement[0m[2m=[0m"\n\nUPDATE router_cache SET category = ? WHERE id = ?\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m0 [3melapsed[0m[2m=[0m3.259819ms [3melapsed_secs[0m[2m=[0m0.003259819
âœ… Corrected router cache for 'Check server latency' -> System
[2m2025-12-06T14:11:44.020925Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
[2m2025-12-06T14:11:44.021867Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m registering event source with poller: token=Token(109511095903616), interests=READABLE | WRITABLE
[2m2025-12-06T14:11:44.022087Z[0m [35mTRACE[0m [2maxum::serve[0m[2m:[0m connection 127.0.0.1:34218 accepted
[2m2025-12-06T14:11:44.022645Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m take? ("https", generativelanguage.googleapis.com): expiration = Some(90s)
[2m2025-12-06T14:11:44.022886Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m reuse idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:44.223046Z[0m [35mTRACE[0m [2mreqwest::retry[0m[2m:[0m shouldn't retry!
[2m2025-12-06T14:11:44.229289Z[0m [35mTRACE[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m put; add idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:44.229859Z[0m [34mDEBUG[0m [2mhyper_util::client::legacy::pool[0m[2m:[0m pooling idle connection for ("https", generativelanguage.googleapis.com)
[2m2025-12-06T14:11:44.779049Z[0m [34mDEBUG[0m [2msqlx::query[0m[2m:[0m [3msummary[0m[2m=[0m"SELECT c.category, c.enhanced_query, v.distance â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT c.category, c.enhanced_query, v.distance\n            FROM vec_router_cache v\n            JOIN router_cache c ON v.rowid = c.id\n            WHERE v.embedding MATCH ? AND k = 1\n            ORDER BY v.distance ASC\n            \n" [3mrows_affected[0m[2m=[0m0 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m549.204993ms [3melapsed_secs[0m[2m=[0m0.549204993
âš¡ Cache Hit! Routing 'Check server latency' to System (Saved ~1s)
[2m2025-12-06T14:11:44.779930Z[0m [35mTRACE[0m [2mmio::poll[0m[2m:[0m deregistering event source from poller
